<html>
    <head>
        <title>D3 Test</title>
        <script type="text/javascript" src="../d3.v2.js"></script>
        <style type="text/css">
	  .axis path,
	  .axis line {
	  fill: none;
	  stroke: black;
	  shape-rendering: crispEdges;
	  }

	  .axis text {
	    font-family: sans-serif;
	    font-size: 11px;
	  }
	</style>
    </head>
    <body>
      <script type="text/javascript">
var w = 900;
var h = 400;
var barPadding = 1;
var padding = 30;
var colorMap = {
    "India": "#1f77b4",
    "Pakistan": "#637939"
};
var svg = d3.select("body")
    .append("svg")
    .attr("width", w)
    .attr("height", h);

function runs(d) {
    return Number(d.performance.Runs);
};

function batAv(d) {
    return Number(d.performance.BatAv);
};

function highScore(d) {
    return Number(d.performance.HS);
};

function team(d) {
    return d.country;
};

d3.json("../data/debuts.json", function(dataset) {
    var xScale = d3.scale.linear()
	.domain([0, d3.max(dataset, function(d) {return runs(d);})])
	.range([2 * padding, w - padding]);

    var yScale = d3.scale.linear()
	.domain([0, d3.max(dataset, function(d) {return batAv(d);})])
	.range([h - padding, padding]);

    var radiusScale = d3.scale.sqrt()
	.domain([0, d3.max(dataset, function(d) {return highScore(d);})])
	.range([0, 20]);

    var circles = svg.append("g")
	.selectAll("circle")
	.data(dataset)
	.enter()
	.append("circle")
	.attr("cx", function(d, i) {return xScale(runs(d));})
	.attr("cy", function(d) {return yScale(d.performance.BatAv);})
	.attr("r", function(d) {return radiusScale(d.performance.HS);})
	.attr("fill", function(d) {
	    return colorMap[team(d)];
	})
	.attr("stroke", "white")
	.attr("opacity", 0.6);
    circles.append("title")
	.text(function(d) {return d.name;});

    var xAxis = d3.svg.axis()
	.scale(xScale)
	.ticks(20)
	.orient("bottom");

    svg.append("g")
	.attr("class", "axis")
	.attr("transform", "translate(0," + (h - padding) + ")")
	.call(xAxis);

    svg.append("text")
    	.text("Runs Scored")
	.attr("x", (w - 2 * padding)/2)
	.attr("y", h);

    var yAxis = d3.svg.axis()
	.scale(yScale)
	.ticks(10)
	.orient("left");

    svg.append("g")
    	.attr("class", "axis")
	.attr("transform", "translate(" +  2 * padding + ", 0)")
    	.call(yAxis);

    
    var yLabel = svg.append("g");
    yLabel.append("text")
    	.text("Batting Average")
	.attr("text-anchor", "middle");

    yLabel.attr("transform", "translate(" + padding/2 + "," +  (h - padding)/2 +") rotate(270)");
});

      </script>
    </body>
</html>
